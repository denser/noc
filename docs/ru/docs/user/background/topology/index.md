# Топология

## Возможности работы НОКа с топологией

Одним из ключевых компонентов НОКа это топология сети. Она представлена в виде графа связности оборудования (`ManagedObject`). 
На его основе можно менять поведение системы, это предоставляет следующие возможности:  

* Строить L2 топологию по данным с оборудования и внешних систем (`Remote System`)
* Строить L2 связи между интерфейсами [Interface](../../reference/concepts/interface/index.md) устройства [ManagedObject](../../reference/concepts/managed-object/index.md).
* Показывать топологию на карте сети
* Определять причины аварии по топологии
* Производить поиск пути по топологии
* Строить отчёты на основании данных по топологии
* Предоставлять топологическую информацию через `API` - [Datastream](../../../dev/reference/api/datastream/managedobject.md)


L2 топология (`L2 Topology`) строится между интерфейсами [Interface](../../reference/concepts/interface/index.md) устройства [ManagedObject](../../reference/concepts/managed-object/index.md). 
Помимо ручного создания связей (`Link`), через интерфейс пользователя, система может выстраивать связи на основе данных с оборудования. Можно выделить следующие этапы работы с топологией:

* Построение связей между устройствами (вручную или по итогам опроса)
* Расчёт направления вверх (`Uplink`)
* Отображение схемы сети
* Построение пути по топологии  


## Построение топологии

При построении топологии важно помнить термины:

* **Связь** (`Линк`) - групп (традиционно 2) 
* **Топологический метод** (`Topology Method`) - это способ по которому строится линк. Обычно они совпадают с топологическими протоколами, но есть несколько дополнительных
* **Текущее устройство** - это устройство на котором запущен опрос.
* **Соседнее устройство** (сосед) - устройство, видимое в списке соседей (кандидатов на построение с ним линка)
* **Идентификатор устройства** 
    * `chassis_id` - MAC адреса устройства
    * `hostname` - `Hostname` устройства
    *   
    * `router_id` - для L3 протоколов

* **Идентификатор порта устройства**
* **Коллекция идентификаторов** - система собирает идентификаторы устройства для поиска устройств. В них входит:

Топология

Построение топологии (Сосед)
* Ручное
* Автоматическое
  * Требования
  * Алгоритм  
  * Методы
  * Настройка

Применение 

### Ручное 

### Автоматическое 

### Требования

### Настройки

### Алгоритм

### Методы

### Отладка

## Расчёт направления вверх

### Level

| Role                   | Level     |
| ---------------------- | --------- |
| **Client's Equipment** | **10-19** |
| CPE                    | 15        |
| **Access Level**       | **20-29** |
| VPN Server             | 22        |
| WiFi Access Point      | 22        |
| Media Gateway          | 23        |
| Access Switch          | 25        |
| **Aggregation Level**  | **30-39** |
| WiFi Controller        | 35        |
| Aggregation Switch     | 38        |
| **City Core**          | **40-49** |
| L3 switch/router       | 42        |
| BRAS                   | 44        |
| MPLS PE                | 44        |
| MPLS P                 | 46        |
| ASBR                   | 48        |
| **Regional Core**      | **50-59** |
| L3 switch/router       | 52        |
| MPLS PE                | 54        |
| MPLS P                 | 56        |
| ASBR                   | 58        |
| **Macroregional Core** | **60-69** |
| L3 switch/router       | 62        |
| MPLS PE                | 64        |
| MPLS P                 | 66        |
| ASBR                   | 68        |
| **National-wide Core** | **70-79** |
| L3 switch/router       | 72        |
| MPLS PE                | 74        |
| MPLS P                 | 76        |
| ASBR                   | 78        |
| **World-wide Core**    | **70-79** |
| L3 switch/router       | 82        |
| MPLS PE                | 84        |
| MPLS P                 | 86        |
| ASBR                   | 88        |


## Работа с топологией

*  Схема сегмента

### Расчёт пути 